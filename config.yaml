# Agent League System - Application Configuration
# This file contains non-secret configuration values
# For sensitive values (API keys, passwords), use .env file

# =============================================================================
# Application Metadata
# =============================================================================
app:
  name: "Agent League System"
  version: "1.0.0"
  description: "Multi-agent tournament system with pluggable game support"
  environment: "development"  # development, staging, production

# =============================================================================
# Server Configuration
# =============================================================================
league_manager:
  host: "localhost"
  port: 8000
  workers: 4
  timeout: 30
  max_requests: 1000
  backlog: 512

referee:
  host: "localhost"
  port: 8001
  workers: 2
  timeout: 60
  max_concurrent_matches: 10

player:
  host: "localhost"
  # Port will be dynamically assigned per player
  base_port: 9000
  max_players: 100

# =============================================================================
# Protocol Configuration
# =============================================================================
protocol:
  version: "1.0"
  jsonrpc_version: "2.0"
  envelope:
    validate_timestamps: true
    max_timestamp_drift_seconds: 300
    require_conversation_id: true
    require_message_id: true

transport:
  max_payload_size_bytes: 1048576  # 1 MB
  connection_timeout: 10
  read_timeout: 30
  write_timeout: 30
  keep_alive: true
  compression: false  # Enable gzip compression

# =============================================================================
# Database Configuration
# =============================================================================
database:
  type: "sqlite"
  path: "./data/league.db"
  pool_size: 10
  max_overflow: 20
  pool_timeout: 30
  pool_recycle: 3600
  echo_sql: false  # Set to true for SQL debugging

  # SQLite specific
  sqlite:
    check_same_thread: false
    timeout: 30
    detect_types: "PARSE_DECLTYPES|PARSE_COLNAMES"

  # PostgreSQL specific (if type: postgresql)
  postgresql:
    # host: from .env
    # port: from .env
    # database: from .env
    # user: from .env
    # password: from .env
    sslmode: "prefer"
    connect_timeout: 10

# =============================================================================
# Game Configuration
# =============================================================================
games:
  default: "tic_tac_toe"
  timeout_seconds: 30
  max_moves: 1000

  # Tic Tac Toe specific
  tic_tac_toe:
    board_size: 3
    win_condition: 3
    timeout_per_move: 5

  # Add more games here
  # connect_four:
  #   board_width: 7
  #   board_height: 6
  #   win_condition: 4

# =============================================================================
# Scheduling Configuration
# =============================================================================
scheduling:
  algorithm: "round_robin"  # round_robin, swiss, elimination
  concurrent_matches: true
  max_matches_per_round: 10
  round_delay_seconds: 1
  match_assignment_strategy: "greedy"  # greedy, optimal

  round_robin:
    ensure_all_pairs: true
    minimize_rounds: true

# =============================================================================
# Standings Configuration
# =============================================================================
standings:
  scoring_system:
    win: 3
    draw: 1
    loss: 0
    forfeit: 0

  tiebreakers:
    - "wins"
    - "point_differential"
    - "head_to_head"
    - "player_id"  # Lexicographic as last resort

  update_frequency: "after_each_match"  # after_each_match, after_each_round, manual

# =============================================================================
# Authentication Configuration
# =============================================================================
auth:
  enabled: true
  token_algorithm: "HS256"
  # token_secret: from .env
  token_expiration_seconds: 3600
  require_verification: true

  agent_types:
    - "league_manager"
    - "referee"
    - "player"

# =============================================================================
# Logging Configuration
# =============================================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  date_format: "%Y-%m-%d %H:%M:%S"

  handlers:
    console:
      enabled: true
      level: "INFO"
      format: "detailed"

    file:
      enabled: true
      level: "DEBUG"
      path: "./logs/agent_league.log"
      max_bytes: 10485760  # 10 MB
      backup_count: 5
      format: "detailed"

    json:
      enabled: false
      path: "./logs/agent_league.json"
      level: "INFO"

  # Component-specific log levels
  loggers:
    "src.league_manager": "INFO"
    "src.referee": "INFO"
    "src.player": "INFO"
    "src.common.transport": "WARNING"
    "src.common.protocol": "WARNING"

# =============================================================================
# Performance Configuration
# =============================================================================
performance:
  cache:
    enabled: true
    backend: "memory"  # memory, redis, memcached
    ttl_seconds: 300
    max_size: 1000

  connection_pool:
    size: 20
    max_overflow: 10
    timeout: 30

  async:
    enabled: true
    max_workers: 10

  rate_limiting:
    enabled: true
    requests_per_second: 100
    burst: 200

# =============================================================================
# Monitoring and Metrics
# =============================================================================
monitoring:
  enabled: true
  port: 9090
  path: "/metrics"
  format: "prometheus"

  metrics:
    - "matches_total"
    - "matches_duration_seconds"
    - "player_registrations"
    - "http_requests_total"
    - "http_request_duration_seconds"
    - "database_queries_total"
    - "database_query_duration_seconds"

  health_check:
    enabled: true
    path: "/health"
    interval_seconds: 30

# =============================================================================
# Error Handling
# =============================================================================
errors:
  retry:
    enabled: true
    max_attempts: 3
    backoff_factor: 2
    max_backoff_seconds: 60

  codes:
    parse_error: -32700
    invalid_request: -32600
    method_not_found: -32601
    invalid_params: -32602
    internal_error: -32603

# =============================================================================
# Development/Testing Configuration
# =============================================================================
development:
  debug_mode: false
  reload_on_change: false
  mock_external_services: false
  enable_debug_endpoints: false
  seed_database: false

  fixtures:
    enabled: false
    path: "./tests/fixtures"

testing:
  database_url: "sqlite:///:memory:"
  disable_auth: false
  fast_mode: false
  parallel: false

# =============================================================================
# Feature Flags
# =============================================================================
features:
  matchmaking: true
  real_time_standings: true
  player_statistics: true
  tournament_mode: false
  ai_players: false
  multi_game_support: true
  websocket_updates: false

# =============================================================================
# Paths and Directories
# =============================================================================
paths:
  data: "./data"
  logs: "./logs"
  results: "./results"
  fixtures: "./tests/fixtures"
  plugins: "./plugins"
  games: "./src/referee/games"

# =============================================================================
# Third-Party Integrations (optional)
# =============================================================================
integrations:
  anthropic:
    enabled: false
    # api_key: from .env
    model: "claude-haiku-20250924"
    max_tokens: 1000
    temperature: 0.7
    timeout: 30

  slack:
    enabled: false
    # webhook_url: from .env
    channel: "#agent-league"

  email:
    enabled: false
    # smtp settings from .env
    from_address: "noreply@agent-league.com"

# =============================================================================
# Budget and Cost Controls
# =============================================================================
budget:
  enabled: false
  monthly_token_limit: 1000000
  daily_token_limit: 50000
  per_game_token_limit: 10000

  alerts:
    warning_threshold: 0.7  # 70% of budget
    critical_threshold: 0.9  # 90% of budget
    emergency_shutoff: 1.0  # 100% of budget

  cost_tracking:
    enabled: false
    currency: "USD"
    input_token_cost_per_million: 3.00
    output_token_cost_per_million: 15.00
